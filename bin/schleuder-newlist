#!/usr/bin/ruby


if ![2,3].include?(ARGV.size) || ARGV.first.match(/^(-h|--help)$/)
    $stderr.puts "Usage: #{File.basename(__FILE__)} list@hostname initadmin@example.org [/path/to/initadminkey]"
    exit 1
end

listname, adminaddr, adminkeypath = ARGV

require_relative '../lib/schleuder.rb'
include Schleuder

errors, list = ListBuilder.new(listname, adminaddr, adminkeypath).run

if errors.present?
  $stderr.puts "Error: #{errors}"
  exit 1
end

$stdout.puts "List #{list.email} successfully created, #{adminaddr} subscribed!"
